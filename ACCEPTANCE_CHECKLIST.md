# ExoQuest Platform - 验收测试清单

## 🎯 验收标准检查

### ✅ 基础设施部署
- [ ] Docker Compose 成功启动所有服务
- [ ] 前端服务在 http://localhost:5173 可访问
- [ ] API服务在 http://localhost:8000 可访问
- [ ] API文档在 http://localhost:8000/docs 可访问
- [ ] MinIO控制台在 http://localhost:9001 可访问
- [ ] Redis服务正常运行
- [ ] MinIO存储桶自动创建成功

### ✅ 数据上传功能
- [ ] CSV文件上传返回dataset_id和object_key
- [ ] 文件保存到MinIO的datasets桶中
- [ ] 文件大小和类型验证正常工作
- [ ] 上传进度显示正常

### ✅ 表格数据预测
- [ ] /predict/tabular接口返回概率和SHAP解释
- [ ] Mock模式下返回realistic JSON数据
- [ ] 前端表格正确显示预测结果
- [ ] SHAP条形图正确渲染

### ✅ 光变曲线预测
- [ ] /predict/curve接口返回预测和importance数组
- [ ] 光变曲线查看器显示三种视图（原始、去趋势、相位折叠）
- [ ] importance热力图正确叠加到曲线上
- [ ] Plotly图表支持缩放和刷选

### ✅ 融合预测
- [ ] /predict/fuse接口正确融合表格和曲线数据
- [ ] alpha参数影响融合权重
- [ ] 返回结果包含两种数据的解释

### ✅ 训练功能
- [ ] /train接口启动训练任务并返回job_id
- [ ] 训练进度通过Redis发布订阅更新
- [ ] 进度从0%到100%正确显示
- [ ] 训练完成后生成模型指标

### ✅ 任务状态监控
- [ ] /jobs/{job_id}/status返回实时状态
- [ ] 前端轮询显示进度条
- [ ] 日志流实时更新
- [ ] 任务完成/失败状态正确处理

### ✅ 模型指标
- [ ] /models/{model_id}/metrics返回PR-AUC、MCC、ECE等指标
- [ ] 混淆矩阵数据正确
- [ ] PR曲线和校准曲线图片生成并保存到MinIO
- [ ] 前端正确显示指标面板

### ✅ 用户反馈
- [ ] /feedback接口接受用户标注
- [ ] 反馈数据保存到MinIO的feedback桶
- [ ] 包含时间戳和反馈ID

### ✅ 模型服务切换
- [ ] USE_MODEL_MOCK=true时使用Mock适配器
- [ ] USE_MODEL_MOCK=false时可切换到真实模型服务
- [ ] MODEL_BASE_URL配置生效
- [ ] 平台代理请求无需代码更改

### ✅ 前端用户体验
- [ ] 探索模式5步引导流程完整
- [ ] 研究模式批量处理、阈值调优、训练、指标面板都可用
- [ ] 阈值滑块实时更新F1/MCC指标
- [ ] 数据导出CSV功能正常
- [ ] 错误处理和Toast通知正常

### ✅ 数据可视化
- [ ] 光变曲线查看器支持三种视图切换
- [ ] SHAP条形图显示全局和局部重要性
- [ ] 阈值调节器显示混淆矩阵和性能指标
- [ ] PR和校准曲线正确显示
- [ ] 所有图表支持下载和全屏

### ✅ 系统集成
- [ ] 前端API调用正确
- [ ] CORS配置允许跨域请求
- [ ] JWT认证token正确传递（演示模式）
- [ ] 错误处理和状态码正确
- [ ] 日志记录完整

## 🧪 手动测试流程

### 1. 基础功能测试
```bash
# 启动系统
./start.sh

# 验证服务状态
curl http://localhost:8000/api/health

# 检查前端加载
open http://localhost:5173
```

### 2. 探索模式测试
1. 访问前端 → 探索模式
2. 选择"使用开普勒-452b示例"
3. 查看光变曲线可视化
4. 点击"开始检测"
5. 查看预测结果和SHAP解释
6. 提供反馈标注

### 3. 研究模式测试
1. 访问前端 → 研究模式
2. 上传CSV文件（或使用示例）
3. 执行批量预测
4. 调整阈值观察指标变化
5. 启动训练任务
6. 监控训练进度
7. 查看模型指标
8. 导出结果

### 4. API测试
```bash
# 表格预测测试
curl -X POST http://localhost:8000/api/predict/tabular \
  -H "Content-Type: application/json" \
  -d '{
    "rows": [{
      "period": 2.5,
      "duration_hr": 3.2,
      "depth_ppm": 850,
      "snr": 15.8,
      "teff": 5800,
      "logg": 4.4,
      "tmag": 10.5,
      "crowding": 0.95
    }],
    "threshold": 0.5
  }'
```

### 5. 模型切换测试
```bash
# 修改环境变量
echo "USE_MODEL_MOCK=false" >> infra/.env
echo "MODEL_BASE_URL=http://localhost:9002" >> infra/.env

# 重启API服务
docker-compose restart api
```

## 📋 部署验证

### Docker环境
- [ ] 所有容器正常启动
- [ ] 容器间网络通信正常
- [ ] 数据卷持久化正常
- [ ] 健康检查通过

### 性能验证
- [ ] 前端页面加载时间 < 3秒
- [ ] API响应时间 < 2秒
- [ ] 批量预测处理速度合理
- [ ] 内存使用量在可接受范围

### 安全验证
- [ ] 文件上传大小限制生效
- [ ] 文件类型验证生效
- [ ] CORS配置正确
- [ ] 敏感信息不在日志中暴露

## 🐛 已知问题和限制

### 当前限制
1. JWT认证仅为演示用途，生产环境需要实现完整的用户管理
2. 数据集列表功能尚未实现（返回空数组）
3. PDF导出功能标记为开发中
4. 模型服务的真实集成需要外部服务配合

### 建议改进
1. 添加用户管理系统
2. 实现更完整的数据集管理
3. 添加更多的数据可视化选项
4. 实现WebSocket实时通信
5. 添加更详细的错误处理和用户提示

## ✅ 验收确认

- [ ] 所有核心功能正常工作
- [ ] Mock模式完全可用
- [ ] 真实模型服务可通过配置切换
- [ ] Docker Compose一键部署成功
- [ ] 文档完整且准确
- [ ] 代码质量符合标准

**验收日期**: _______________  
**验收人员**: _______________  
**备注**: _______________
